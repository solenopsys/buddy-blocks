 ВОТ ОНО!

  Когда pipe пустой:
  - tee() возвращает 0
  - splice() возвращает 0
  - recv() возвращает хеш пустой строки: e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855

  Это ТОЧНО ТО ЖЕ что мы видели в логах сервера! MockService: onHashForBlock(block_num=0, size_index=0, 
  hash=e3b0c44298fc1c14...)

  Вывод: первая операция splice(socket → pipe1) возвращает 0 байт! Данные от клиента не попадают в pipe1!

  Проблема скорее всего в том, что:
  1. Либо HTTP тело ещё не пришло от клиента когда мы делаем splice
  2. Либо splice пытается читать из socket в неблокирующем режиме и сразу возвращает 0
  3. Либо Content-Length неправильно парсится

  Нужно добавить в сервер логирование результата первого splice!